# 무한 스크롤 UI 구현하기
---
- 모바일 환경을 가정한다.
- **무한 스크롤이란?**
  - 컨텐츠를 페이징하는 기법 중 하나로, 아래로 스크롤하다가 컨텐츠의 마지막 요소를 볼 때쯤 다음 컨텐츠가 있으면 불러오는 방식
  - Facebook, Twitter, Instagram에서 많이 사용된다.
- **구현 방식**
  1. window의 scroll 이벤트를 통해 스크롤링이 일어날 때마다 화면 전체의 height와 스크롤 위치를 통해 스크롤이 컨텐츠의 끝 즈음에 다다랐는지 체크해서 처리하는 방식
  2. intersection observer 방식 : 내가 지정한 DOM요소가 사용자가 보고 있는 시야에 닿았는지 감지하여 처리하는 방식

![컴포넌트 구조](/infiniteScroll/img/컴포넌트%20구조.png)
  
- 불러온 데이터를 photoList라는 이름으로 PhotoList 컴포넌트에 내려줌.
- PhotoList 컴포넌트에서는 스크롤이 그리는 화면의 끝에 거의 다다랐으면 App에서 넘겨준 onScrollEnded 콜백 함수를 실행시킨다.
- 사용할 API
```javascript
// limit : 한 번에 가져올 고양이 사진의 개수, 5로 고정
// start : 몇 번째 사진부터 가져올 건지
'https://mwu.roto-frontend.programmers.co.kr/cat-photos?_limit=${limit}&_start=${start}'
```
## (1)
- 스크롤을 이용해서 컨텐츠의 끝에 닿아가는지 확인하는 로직을 구현
- 끝에 닿으면 onScrollEnded를 호출해서 다음 데이터를 받아온다.(API 이용)
- 원래 있던 데이터에 다음 데이터를 setState로 붙인다.

## (2)
- 더보기를 넣기 전에 버튼을 눌러서 다음 데이터를 불러오는 UI를 먼저 해볼 것이다. 데이터를 불러오는게 잘 되면 버튼에서 스크롤로 바꾼다.

## (3)
- 데이터를 로드할 때 인터넷 속도가 느려서 로딩 중이라면 다음 로딩은 하지 않도록 하는 기능 = throttle

## (4)
- `document.body.offsetHeight` : 화면에 렌더링된 전체 높이
- `window.innerHeight` : 현재 높이
- `window.scrollY` : 스크롤된 값
- `debounce`는 일정 시간내에 똑같은 이벤트가 발생하면 이벤트를 지연시켜서 지연시간 내에 똑같은 이벤트가 발생하면 이전 이벤트를 취소시키고 발생하지 않는다면 지연시간이 지난 후에 가장 마지막에 발생된 이벤트를 trigger시키는 기술
- `throttle` : 가장 처음에 들어온 이벤트만 trigger하고 일정시간 내에 들어오는 같은 이벤트는 모두 취소시키는 기술
- 데이터가 마지막인지 체크하는 방법 : 컨텐츠 전체 개수를 불러와서 현재 내가 가져온 데이터의 전체 개수를 비교해서 확인 or 5개씩 불러오도록 했는데 다음에 불러온 데이터가 5개 미만이라면 마지막으로 확인하는 방법

## (5)
- `intersection observer` : 가장 마지막의 li가 화면에 보이는 걸 감지 후 다음 데이터를 불러서 렌더링한다.
- 만약 데이터가 로딩중이라면 또 데이터를 불러오는 것을 방지하는 코드를 넣어줘야 한다.